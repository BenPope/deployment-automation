apiVersion: v1
kind: Pod
metadata:
  name: "{{ include "redpanda.fullname" . }}-test-api-status"
  labels:
    {{- include "redpanda.labels" . | nindent 4 }}
  annotations:
    "helm.sh/hook": test
spec:
  restartPolicy: Never
  containers:
    - name: {{ template "redpanda.name" . }}
      image: {{ .Values.image.repository }} 
      args: ["api", "status", "--brokers", "{{ include "redpanda.name" . }}:{{ .Values.config.redpanda.advertised_kafka_api.port }}"]
      volumeMounts:
        - name: base-config 
          mountPath: /tmp/base-config 
  volumes:
    - name: base-config
      configMap:
        name: base-config
    - name: config
      emptyDir: {}
